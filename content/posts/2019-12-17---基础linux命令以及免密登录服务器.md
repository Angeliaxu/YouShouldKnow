---
title: linux命令以及免密登录服务器
date: "2019-12-17"
template: "post"
draft: false
slug: "/post/bascicOrder/"
category: "Linux"
tags: 
    - "Linux"
description: "整理一篇属于自己的Linux命令总结，以及使用ssh进行免密登录服务器的配置详解。便于每次换电脑的时候可以有迹可查，迅速搭建好自己的环境，便于开发。"
socialImage: "/media/42-line-bible.jpg"
---

整理一篇属于自己的Linux命令总结，以及使用ssh进行免密登录服务器的配置详解。便于每次换电脑的时候可以有迹可查，迅速搭建好自己的环境，便于开发。

### SSH免密登录
1.  生成SSH key 简单使用`ssh-keygen`，会一步一步的给你提示。创建出来的文件名默认为使用RSA算法所以文件名为id_rsa。当然还有其他的算法默认文件名。例如 id_dsa，id_ecdsa。  

```
ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ylo/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/ylo/.ssh/id_rsa.
Your public key has been saved in /home/ylo/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:Up6KjbnEV4Hgfo75YM393QdQsK3Z0aTNBz0DoirrW+c ylo@klar
The key's randomart image is:
+---[RSA 2048]----+
|    .      ..oo..|
|   . . .  . .o.X.|
|    . . o.  ..+ B|
|   .   o.o  .+ ..|
|    ..o.S   o..  |
|   . %o=      .  |
|    @.B...     . |
|   o.=. o. . .  .|
|    .oo  E. . .. |
+----[SHA256]-----+
```
其他的算法：   
- rsa：一种老的算法，密钥的大小推荐是2048bits，4096bits是最好的选择。不是很建议使用rsa这种算法来生成密钥，因为会很容易被破解。
- dsa：一种老的算法，不推荐使用。
- ecdsa：由US政府推出来的新算法，目前来说算是最推荐使用的一种算法。大小有256，384，521。推荐使用521。
- ed25519： 一种新的算法，不是很多客户端支持。

使用-t参数指定哪种算法，-b指出生成的key大小，-f指定key的名称，-c 为publicKey添加备注
```
ssh-gen -f "test" -t rsa -b 4096 -c "comment"
```
 然后生成test密钥与test.pub 公钥。然后公钥长这样。
```
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDBX/cZo97cr06stbklxM+BBfP0FCD37lygzMApFmvi2Lcj+V/6tQeSvdcfLCYn6XPzSWXTa5zIx/hHxVJnp8/sKrrwoCAf4FWQKDW4AKnFBtU/coqhqV1TAfEDS/q8O8PdOvCiPuKlYUnLjQGQWRwpD93N7VWUOUrE4Wynbu/sY472Yjoq3AlzqIEvh9dVe+va6eCI1TJCEIrhqsXKXqmGgtQWl0vfUSB04jHMLEFTZ+b0slB47Wm5EUPXqYf+G6+HntSrGQPeRQtiGBGtRTxlqjuhGGVVCVgBo92mOkMuQlXfK1QarnTnQeLRgon7Dkqs+pFmNGfwJ38FQb5qcjHr comment
```

2. 上传公钥到服务器，两种方式，一种直接把公钥拷贝到服务器ssh目录下的`authorized_keys`里面。第二种方式使用命令行。`-i `代表idenrify
``` 
ssh-copy-id -i ~/.ssh/test.pub user@host
```
这样可以直接把指定的私钥上传到服务器`authorized_keys`里面。

3.  这一步分两种情况，如果你在生成key文件的时候没有指定文件名，那么默认就是`id_rsa.pub`和`id_rsa`。并且上传到服务器。此时在本地就可以通过`ssh root@ip`进行免密登录。第二种情况是本地存了很多对key文件并且配置到不同的服务器上，此时登录到服务器时需要指定哪个私钥来进行登录。`ssh -i 私钥文件 root@ip`。   

4.  设置多主机配置。把文件命名为`config`放在本机`ssh`目录下。然后进行下列配置，主要就是配置ip，用户名，以及需要验证的密钥。直接在本机输入`ssh Host名`登录到服务器。
```
// 多主机配置1
Host gateway-produce
HostName IP或绑定的域名
Port 22
Host node-produce
HostName IP或绑定的域名
Port 22
Host java-produce
HostName IP或绑定的域名
Port 22
```
```
// 多主机配置2
Host *-produce
User root
IdentityFile ~/.ssh/produce_key_rsa
Protocol 2
Compression yes
ServerAliveInterval 60
ServerAliveCountMax 20
LogLevel INFO
```
```
// 单主机配置1
Host evil-cloud
User root
HostName IP或绑定的域名
IdentityFile ~/.ssh/test1_rsa
Protocol 2
Compression yes
ServerAliveInterval 60
ServerAliveCountMax 20
LogLevel INFO
```
```
// 单主机配置2
Host git.yideng.site
User git
IdentityFile ~/.ssh/test2_rsa
Protocol 2
Compression yes
ServerAliveInterval 60
ServerAliveCountMax 20
LogLevel INFO
```
以上就是ssh免密登录的配置过程。

### Linux下常用的命令以及基础知识
